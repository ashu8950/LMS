package com.admin_service.controller;

import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/admin")
public class AdminController {

    private final UserClient userClient;
    private final BatchClient batchClient;
    private final CourseClient courseClient;
    private final ReportingClient reportingClient;

    public AdminController(UserClient userClient, BatchClient batchClient,
                           CourseClient courseClient, ReportingClient reportingClient) {
        this.userClient = userClient;
        this.batchClient = batchClient;
        this.courseClient = courseClient;
        this.reportingClient = reportingClient;
    }

    // User Management
    @PostMapping("/user")
    public ResponseEntity<?> createUser(@RequestBody UserDto userDto) {
        return userClient.createUser(userDto);
    }

    @GetMapping("/users/{role}")
    public ResponseEntity<?> getUsersByRole(@PathVariable String role) {
        return ResponseEntity.ok(userClient.getUsersByRole(role));
    }

    // Batch Management
    @PostMapping("/batch")
    public ResponseEntity<?> createBatch(@RequestBody BatchDto batchDto) {
        return batchClient.createBatch(batchDto);
    }

    @PostMapping("/batch/{id}/assign")
    public ResponseEntity<?> assignInstructor(@PathVariable Long id, @RequestBody InstructorAssignmentDto dto) {
        return batchClient.assignInstructor(id, dto);
    }

    // Course Management
    @PostMapping("/course")
    public ResponseEntity<?> createCourse(@RequestBody CourseDto dto) {
        return courseClient.createCourse(dto);
    }

    // Reports
    @GetMapping("/report/student/{id}")
    public ResponseEntity<?> getStudentReport(@PathVariable Long id) {
        return reportingClient.getStudentReport(id);
    }

    @GetMapping("/report/batch/{id}")
    public ResponseEntity<?> getBatchReport(@PathVariable Long id) {
        return reportingClient.getBatchReport(id);
    }
}
